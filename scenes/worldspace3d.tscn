[gd_scene load_steps=9 format=3 uid="uid://c8uvtud87j7bm"]

[ext_resource type="PackedScene" uid="uid://2q6yeun0jg1p" path="res://scenes/clipmap.tscn" id="1_5mt3c"]
[ext_resource type="PackedScene" uid="uid://bbonwc6tlp0h5" path="res://scenes/character.tscn" id="2_8tygs"]
[ext_resource type="Environment" uid="uid://bckwhfhefd78o" path="res://resources/environment/default_environment_skyshader.tres" id="3_41m2g"]
[ext_resource type="Script" path="res://scripts/environment_manager_3d.gd" id="3_xjbbb"]
[ext_resource type="PackedScene" uid="uid://b21bnrx0i5bfk" path="res://scenes/temporary/shader_test_shapes.tscn" id="4_wjbrr"]
[ext_resource type="Shader" path="res://resources/shader/lens_flare.gdshader" id="5_x86fy"]

[sub_resource type="ShaderMaterial" id="ShaderMaterial_iggtm"]
shader = ExtResource("5_x86fy")
shader_parameter/sun_position = Vector2(0, 0)
shader_parameter/tint = Vector3(1.4, 1.2, 1)

[sub_resource type="BoxMesh" id="BoxMesh_rinyd"]
size = Vector3(20, 20, 20)

[node name="Worldspace3d" type="Node3D"]

[node name="Clipmap" parent="." instance=ExtResource("1_5mt3c")]

[node name="PlayerRegistry" type="Node" parent="."]

[node name="Character" parent="PlayerRegistry" instance=ExtResource("2_8tygs")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 40, 0)

[node name="3dEnvironmentManager" type="Node" parent="."]
script = ExtResource("3_xjbbb")

[node name="WorldEnvironment" type="WorldEnvironment" parent="3dEnvironmentManager"]
environment = ExtResource("3_41m2g")

[node name="WorldTime" type="Timer" parent="3dEnvironmentManager"]
wait_time = 0.25
autostart = true

[node name="SunMoonRotationFix" type="Node3D" parent="3dEnvironmentManager"]
transform = Transform3D(1, 0, 0, 0, -4.37114e-08, 1, 0, -1, -4.37114e-08, 0, 100, 0)

[node name="Sun" type="DirectionalLight3D" parent="3dEnvironmentManager/SunMoonRotationFix"]
light_color = Color(0.811765, 0.811765, 0.811765, 1)
light_energy = 0.7
directional_shadow_blend_splits = true

[node name="Moon" type="DirectionalLight3D" parent="3dEnvironmentManager/SunMoonRotationFix"]
light_color = Color(0.513726, 0.666667, 0.721569, 1)
light_energy = 0.185
light_indirect_energy = 0.37
light_volumetric_fog_energy = 1.5
directional_shadow_blend_splits = true

[node name="SunFlare" type="CanvasLayer" parent="3dEnvironmentManager"]
follow_viewport_enabled = true

[node name="SunFlare" type="ColorRect" parent="3dEnvironmentManager/SunFlare"]
material = SubResource("ShaderMaterial_iggtm")
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
mouse_filter = 2

[node name="ShaderTestShapes" parent="." instance=ExtResource("4_wjbrr")]
transform = Transform3D(0.999997, 0.00226893, 0, -0.00225187, 0.99248, 0.122389, 0.000277692, -0.122389, 0.992482, -18.8341, 36.1398, 0)

[node name="BigCube" type="MeshInstance3D" parent="."]
transform = Transform3D(0.575819, 0.685864, -0.444997, 0, 0.544288, 0.838899, 0.817577, -0.483054, 0.313411, -47.4056, 51.7734, 0)
mesh = SubResource("BoxMesh_rinyd")

[connection signal="timeout" from="3dEnvironmentManager/WorldTime" to="3dEnvironmentManager" method="_on_world_time_timeout"]
